# -*- coding: utf-8 -*-
from pyspark.sql.functions import udf
from pyspark.sql.types import StringType

# 字典:仅包含映射值不同的部分
dict_entry_map = {
    "SQ63": {
        "ct_ck.trade_type": {
            "1": "11",
            "2": "12",
            "6": "12"
        },
        "ct_ck.id_type": {
            "A": "a",
            "B": "b",
            "C": "c",
            "D": "d",
            "F": "f",
            "G": "g",
            "H": "h",
            "I": "i",
            "J": "j",
            "K": "k",
            "L": "l",
            "M": "P",
            "N": "y",
            "O": "N"
        },
        "ct_ck.sett_trade_type": {
            "31": "2",
            "11": "0",
            "12": "0",
            "21": "1"
        },
        "ct_ck.bank_no": {
            "Z": "z"
        },
        "ct_ck.money_type": {
            "AUD": "7",
            "CAD": "6",
            "CHF": "5",
            "CNY": "0",
            "EUR": "8",
            "GBP": "4",
            "HKD": "2",
            "JPY": "3",
            "OTH": "9",
            "USD": "1"
        },
        "ct_ck.isactive": {
            "1": "0",
            "0": "3"
        },
        "ct_ck.assetmanagetype": {
            "1": "2",
            "2": "3"
        },
        "ct_ck.province_cn": {
            "156360000": "江西省",
            "156410000": "河南省",
            "156140000": "山西省",
            "156220000": "吉林省",
            "156320000": "江苏省",
            "156420000": "湖北省",
            "156520000": "贵州省",
            "156610000": "陕西省",
            "156810000": "香港特别行政区",
            "156150000": "内蒙古自治区",
            "156620000": "甘肃省",
            "156120000": "天津市",
            "156370000": "山东省",
            "156440000": "广东省",
            "156820000": "澳门特别行政区",
            "156330000": "浙江省",
            "156430000": "湖南省",
            "156500000": "重庆市",
            "156630000": "青海省",
            "156710000": "台湾省",
            "156530000": "云南省",
            "156210000": "辽宁省",
            "156340000": "安徽省",
            "156450000": "广西壮族自治区",
            "156460000": "海南省",
            "156130000": "河北省",
            "156350000": "福建省",
            "156510000": "四川省",
            "156540000": "西藏自治区",
            "156640000": "宁夏回族自治区",
            "156110000": "北京市",
            "156230000": "黑龙江省",
            "156310000": "上海市",
            "156650000": "新疆维吾尔自治区"
        },
        "ct_ck.city_cn": {
            "156441600": "河源市",
            "156441700": "阳江市",
            "156441800": "清远市",
            "156441900": "东莞市",
            "156442000": "中山市",
            "156445100": "潮州市",
            "156445200": "揭阳市",
            "156445300": "云浮市",
            "156450100": "南宁市",
            "156450200": "柳州市",
            "156450300": "桂林市",
            "156450400": "梧州市",
            "156450500": "北海市",
            "156450600": "防城港市",
            "156450700": "钦州市",
            "156450800": "贵港市",
            "156450900": "玉林市",
            "156451000": "百色市",
            "156451100": "贺州市",
            "156451200": "河池市",
            "156451300": "来宾市",
            "156451400": "崇左市",
            "156460100": "海口市",
            "156460200": "三亚市",
            "156469001": "五指山市",
            "156469002": "琼海市",
            "156469003": "儋州市",
            "156469005": "文昌市",
            "156469006": "万宁市",
            "156469007": "东方市",
            "156469025": "定安县",
            "156469026": "屯昌县",
            "156469027": "澄迈县",
            "156469028": "临高县",
            "156469030": "白沙黎族自治县",
            "156469031": "昌江黎族自治县",
            "156469033": "乐东黎族自治县",
            "156469034": "陵水黎族自治县",
            "156469035": "保亭黎族苗族自治县",
            "156469036": "琼中黎族苗族自治县",
            "156469037": "西沙群岛",
            "156469038": "南沙群岛",
            "156469039": "中沙群岛的岛礁及其海域",
            "156500101": "万州区",
            "156500102": "涪陵区",
            "156500103": "渝中区",
            "156500104": "大渡口区",
            "156500105": "江北区",
            "156500106": "沙坪坝区",
            "156500107": "九龙坡区",
            "156500108": "南岸区",
            "156500109": "北碚区",
            "156500110": "万盛区",
            "156500111": "双桥区",
            "156500112": "渝北区",
            "156500113": "巴南区",
            "156500114": "黔江区",
            "156500115": "长寿区",
            "156500222": "綦江县",
            "156500223": "潼南县",
            "156500224": "铜梁县",
            "156500225": "大足县",
            "156500226": "荣昌县",
            "156500227": "璧山县",
            "156500228": "梁平县",
            "156500229": "城口县",
            "156500230": "丰都县",
            "156500231": "垫江县",
            "156500232": "武隆县",
            "156500233": "忠县",
            "156500234": "开县",
            "156500235": "云阳县",
            "156500236": "奉节县",
            "156500237": "巫山县",
            "156500238": "巫溪县",
            "156500240": "石柱土家族自治县",
            "156500241": "秀山土家族苗族自治县",
            "156500242": "酉阳土家族苗族自治县",
            "156500243": "彭水苗族土家族自治县",
            "156500381": "江津市",
            "156500382": "合川市",
            "156500383": "永川市",
            "156500384": "南川市",
            "156510100": "成都市",
            "156510300": "自贡市",
            "156510400": "攀枝花市",
            "156510500": "泸州市",
            "156510600": "德阳市",
            "156510700": "绵阳市",
            "156510800": "广元市",
            "156510900": "遂宁市",
            "156511000": "内江市",
            "156511100": "乐山市",
            "156511300": "南充市",
            "156511400": "眉山市",
            "156511500": "宜宾市",
            "156511600": "广安市",
            "156511700": "达州市",
            "156511800": "雅安市",
            "156511900": "巴中市",
            "156512000": "资阳市",
            "156513200": "阿坝藏族羌族自治州",
            "156513300": "甘孜藏族自治州",
            "156513400": "凉山彝族自治州",
            "156520100": "贵阳市",
            "156520200": "六盘水市",
            "156520300": "遵义市",
            "156520400": "安顺市",
            "156522200": "铜仁地区",
            "156522300": "黔西南布依族苗族自治州",
            "156522400": "毕节地区",
            "156522600": "黔东南苗族侗族自治州",
            "156522700": "黔南布依族苗族自治州",
            "156530100": "昆明市",
            "156530300": "曲靖市",
            "156530400": "玉溪市",
            "156530500": "保山市",
            "156530600": "昭通市",
            "156530700": "丽江市",
            "156530800": "思茅市",
            "156530900": "临沧市",
            "156532300": "楚雄彝族自治州",
            "156532500": "红河哈尼族彝族自治州",
            "156532600": "文山壮族苗族自治州",
            "156532800": "西双版纳傣族自治州",
            "156532900": "大理白族自治州",
            "156533100": "德宏傣族景颇族自治州",
            "156533300": "怒江傈僳族自治州",
            "156533400": "迪庆藏族自治州",
            "156540100": "拉萨市",
            "156542100": "昌都地区",
            "156542200": "山南地区",
            "156542300": "日喀则地区",
            "156542400": "那曲地区",
            "156542500": "阿里地区",
            "156542600": "林芝地区",
            "156610100": "西安市",
            "156610200": "铜川市",
            "156610300": "宝鸡市",
            "156610400": "咸阳市",
            "156610500": "渭南市",
            "156610600": "延安市",
            "156610700": "汉中市",
            "156610800": "榆林市",
            "156610900": "安康市",
            "156611000": "商洛市",
            "156620100": "兰州市",
            "156620200": "嘉峪关市",
            "156620300": "金昌市",
            "156620400": "白银市",
            "156620500": "天水市",
            "156620600": "武威市",
            "156620700": "张掖市",
            "156620800": "平凉市",
            "156620900": "酒泉市",
            "156621000": "庆阳市",
            "156621100": "定西市",
            "156621200": "陇南市",
            "156622900": "临夏回族自治州",
            "156623000": "甘南藏族自治州",
            "156630100": "西宁市",
            "156632100": "海东地区",
            "156632200": "海北藏族自治州",
            "156632300": "黄南藏族自治州",
            "156632500": "海南藏族自治州",
            "156632600": "果洛藏族自治州",
            "156632700": "玉树藏族自治州",
            "156632800": "海西蒙古族藏族自治州",
            "156640100": "银川市",
            "156640200": "石嘴山市",
            "156640300": "吴忠市",
            "156640400": "固原市",
            "156640500": "中卫市",
            "156650100": "乌鲁木齐市",
            "156650200": "克拉玛依市",
            "156652100": "吐鲁番地区",
            "156652200": "哈密地区",
            "156652300": "昌吉回族自治州",
            "156652700": "博尔塔拉蒙古自治州",
            "156652800": "巴音郭楞蒙古自治州",
            "156652900": "阿克苏地区",
            "156653000": "克孜勒苏柯尔克孜自治州",
            "156653100": "喀什地区",
            "156653200": "和田地区",
            "156654000": "伊犁哈萨克自治州",
            "156654200": "塔城地区",
            "156654300": "阿勒泰地区",
            "156659001": "石河子市",
            "156659002": "阿拉尔市",
            "156659003": "图木舒克市",
            "156659004": "五家渠市",
            "156110101": "东城区",
            "156110102": "西城区",
            "156110103": "崇文区",
            "156110104": "宣武区",
            "156110105": "朝阳区",
            "156110106": "丰台区",
            "156110107": "石景山区",
            "156110108": "海淀区",
            "156110109": "门头沟区",
            "156110111": "房山区",
            "156110112": "通州区",
            "156110113": "顺义区",
            "156110114": "昌平区",
            "156110115": "大兴区",
            "156110116": "怀柔区",
            "156110117": "平谷区",
            "156110228": "密云县",
            "156110229": "延庆县",
            "156120101": "和平区",
            "156120102": "河东区",
            "156120103": "河西区",
            "156120104": "南开区",
            "156120105": "河北区",
            "156120106": "红桥区",
            "156120107": "塘沽区",
            "156120108": "汉沽区",
            "156120109": "大港区",
            "156120110": "东丽区",
            "156120111": "西青区",
            "156120112": "津南区",
            "156120113": "北辰区",
            "156120114": "武清区",
            "156120115": "宝坻区",
            "156120221": "宁河县",
            "156120223": "静海县",
            "156120225": "蓟县",
            "156130100": "石家庄市",
            "156130200": "唐山市",
            "156130300": "秦皇岛市",
            "156130400": "邯郸市",
            "156130500": "邢台市",
            "156130600": "保定市",
            "156130700": "张家口市",
            "156130800": "承德市",
            "156130900": "沧州市",
            "156131000": "廊坊市",
            "156131100": "衡水市",
            "156140100": "太原市",
            "156140200": "大同市",
            "156140300": "阳泉市",
            "156140400": "长治市",
            "156140500": "晋城市",
            "156140600": "朔州市",
            "156140700": "晋中市",
            "156140800": "运城市",
            "156140900": "忻州市",
            "156141000": "临汾市",
            "156141100": "吕梁市",
            "156150100": "呼和浩特市",
            "156150200": "包头市",
            "156150300": "乌海市",
            "156150400": "赤峰市",
            "156150500": "通辽市",
            "156150600": "鄂尔多斯市",
            "156150700": "呼伦贝尔市",
            "156150800": "巴彦淖尔市",
            "156150900": "乌兰察布市",
            "156152200": "兴安盟",
            "156152500": "锡林郭勒盟",
            "156152900": "阿拉善盟",
            "156210100": "沈阳市",
            "156210200": "大连市",
            "156210300": "鞍山市",
            "156210400": "抚顺市",
            "156210500": "本溪市",
            "156210600": "丹东市",
            "156210700": "锦州市",
            "156210800": "营口市",
            "156210900": "阜新市",
            "156211000": "辽阳市",
            "156211100": "盘锦市",
            "156211200": "铁岭市",
            "156211300": "朝阳市",
            "156211400": "葫芦岛市",
            "156220100": "长春市",
            "156220200": "吉林市",
            "156220300": "四平市",
            "156220400": "辽源市",
            "156220500": "通化市",
            "156220600": "白山市",
            "156220700": "松原市",
            "156220800": "白城市",
            "156222400": "延边朝鲜族自治州",
            "156230100": "哈尔滨市",
            "156230200": "齐齐哈尔市",
            "156230300": "鸡西市",
            "156230400": "鹤岗市",
            "156230500": "双鸭山市",
            "156230600": "大庆市",
            "156230700": "伊春市",
            "156230800": "佳木斯市",
            "156230900": "七台河市",
            "156231000": "牡丹江市",
            "156231100": "黑河市",
            "156231200": "绥化市",
            "156232700": "大兴安岭地区",
            "156310101": "黄浦区",
            "156310103": "卢湾区",
            "156310104": "徐汇区",
            "156310105": "长宁区",
            "156310106": "静安区",
            "156310107": "普陀区",
            "156310108": "闸北区",
            "156310109": "虹口区",
            "156310110": "杨浦区",
            "156310112": "闵行区",
            "156310113": "宝山区",
            "156310114": "嘉定区",
            "156310115": "浦东新区",
            "156310116": "金山区",
            "156310117": "松江区",
            "156310118": "青浦区",
            "156310119": "南汇区",
            "156310120": "奉贤区",
            "156310230": "崇明县",
            "156320100": "南京市",
            "156320200": "无锡市",
            "156320300": "徐州市",
            "156320400": "常州市",
            "156320500": "苏州市",
            "156320600": "南通市",
            "156320700": "连云港市",
            "156320800": "淮安市",
            "156320900": "盐城市",
            "156321000": "扬州市",
            "156321100": "镇江市",
            "156321200": "泰州市",
            "156321300": "宿迁市",
            "156330100": "杭州市",
            "156330200": "宁波市",
            "156330300": "温州市",
            "156330400": "嘉兴市",
            "156330500": "湖州市",
            "156330600": "绍兴市",
            "156330700": "金华市",
            "156330800": "衢州市",
            "156330900": "舟山市",
            "156331000": "台州市",
            "156331100": "丽水市",
            "156340100": "合肥市",
            "156340200": "芜湖市",
            "156340300": "蚌埠市",
            "156340400": "淮南市",
            "156340500": "马鞍山市",
            "156340600": "淮北市",
            "156340700": "铜陵市",
            "156340800": "安庆市",
            "156341000": "黄山市",
            "156341100": "滁州市",
            "156341200": "阜阳市",
            "156341300": "宿州市",
            "156341400": "巢湖市",
            "156341500": "六安市",
            "156341600": "亳州市",
            "156341700": "池州市",
            "156341800": "宣城市",
            "156350100": "福州市",
            "156350200": "厦门市",
            "156350300": "莆田市",
            "156350400": "三明市",
            "156350500": "泉州市",
            "156350600": "漳州市",
            "156350700": "南平市",
            "156350800": "龙岩市",
            "156350900": "宁德市",
            "156360100": "南昌市",
            "156360200": "景德镇市",
            "156360300": "萍乡市",
            "156360400": "九江市",
            "156360500": "新余市",
            "156360600": "鹰潭市",
            "156360700": "赣州市",
            "156360800": "吉安市",
            "156360900": "宜春市",
            "156361000": "抚州市",
            "156361100": "上饶市",
            "156370100": "济南市",
            "156370200": "青岛市",
            "156370300": "淄博市",
            "156370400": "枣庄市",
            "156370500": "东营市",
            "156370600": "烟台市",
            "156370700": "潍坊市",
            "156370800": "济宁市",
            "156370900": "泰安市",
            "156371000": "威海市",
            "156371100": "日照市",
            "156371200": "莱芜市",
            "156371300": "临沂市",
            "156371400": "德州市",
            "156371500": "聊城市",
            "156371600": "滨州市",
            "156371700": "菏泽市",
            "156410100": "郑州市",
            "156410200": "开封市",
            "156410300": "洛阳市",
            "156410400": "平顶山市",
            "156410500": "安阳市",
            "156410600": "鹤壁市",
            "156410700": "新乡市",
            "156410800": "焦作市",
            "156410900": "濮阳市",
            "156411000": "许昌市",
            "156411100": "漯河市",
            "156411200": "三门峡市",
            "156411300": "南阳市",
            "156411400": "商丘市",
            "156411500": "信阳市",
            "156411600": "周口市",
            "156411700": "驻马店市",
            "156420100": "武汉市",
            "156420200": "黄石市",
            "156420300": "十堰市",
            "156420500": "宜昌市",
            "156420600": "襄樊市",
            "156420700": "鄂州市",
            "156420800": "荆门市",
            "156420900": "孝感市",
            "156421000": "荆州市",
            "156421100": "黄冈市",
            "156421200": "咸宁市",
            "156421300": "随州市",
            "156422800": "恩施土家族苗族自治州",
            "156429004": "仙桃市",
            "156429005": "潜江市",
            "156429006": "天门市",
            "156429021": "神农架林区",
            "156430100": "长沙市",
            "156430200": "株洲市",
            "156430300": "湘潭市",
            "156430400": "衡阳市",
            "156430500": "邵阳市",
            "156430600": "岳阳市",
            "156430700": "常德市",
            "156430800": "张家界市",
            "156430900": "益阳市",
            "156431000": "郴州市",
            "156431100": "永州市",
            "156431200": "怀化市",
            "156431300": "娄底市",
            "156433100": "湘西土家族苗族自治州",
            "156440100": "广州市",
            "156440200": "韶关市",
            "156440300": "深圳市",
            "156440400": "珠海市",
            "156440500": "汕头市",
            "156440600": "佛山市",
            "156440700": "江门市",
            "156440800": "湛江市",
            "156440900": "茂名市",
            "156441200": "肇庆市",
            "156441300": "惠州市",
            "156441400": "梅州市",
            "156441500": "汕尾市",
        }
    }
}


# 定义python查字典函数
def get_subentry(data_source, entry_no, sc_subentry):
    if data_source in dict_entry_map and \
            entry_no in dict_entry_map[data_source] and \
            sc_subentry in dict_entry_map[data_source][entry_no]:
        return dict_entry_map[data_source][entry_no][sc_subentry]
    else:
        return sc_subentry  # 字典里面没有就取自身
